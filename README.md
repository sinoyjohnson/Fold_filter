# Fold_filter: Filter DEG Results and Extract FASTA Sequences

## Description

**Fold\_filter** is a command-line Python tool designed to filter differential gene expression (DEG) results generated by popular tools like **EdgeR** and **DESeq2**. It allows users to filter DEGs based on user-defined absolute log2 fold change and p-value (or adjusted p-value) cutoffs.

Additionally, if a FASTA assembly file is provided, the tool can extract the corresponding FASTA sequences for the filtered DEGs. The sequence matching is based on the longest common prefix between the transcript IDs in the DEG results and the headers in the FASTA file.

## Features

* Filters DEG results from EdgeR and DESeq2.
* Filters based on absolute log2 fold change and p-value (or adjusted p-value).
* Optionally extracts FASTA sequences of filtered DEGs from an assembly file.
* Utilizes multiprocessing for faster FASTA sequence extraction.
* Accepts CSV and TSV/TXT input files.
* User-friendly command-line interface.

## Usage

python Fold_filter-v1.1.py <input_file> <output_prefix> --log2fc <float> --pvalue <float> --tool <edgeR|deseq2> [--fasta_assembly <fasta_file>] [--threads <int>] [--log2fc_col <string>] [--pvalue_col <string>] [--use_adjusted_pvalue] [--remove_duplicates]

Arguments
<input_file>: Path to the input CSV/TSV file containing DEG results.
<output_prefix>: Prefix for the output files (e.g., filtered_degs). This will create [output_prefix]_filtered.csv and optionally [output_prefix]_filtered.fasta.
--log2fc <float>: Absolute log2 fold change cutoff (e.g., 1.0).
--pvalue <float>: P-value cutoff (e.g., 0.05).
--tool <edgeR|deseq2>: The DEG analysis tool used (edgeR or deseq2).
--fasta_assembly <fasta_file> (optional): Path to the Trinity assembly FASTA file for sequence extraction.
--threads <int> (optional): Number of threads to use for FASTA parsing (default:1)

## Installation

No installation is required. Simply download the Python script (`Fold_filter-v1.1.py`) and ensure you have Python 3 and the Biopython and pandas libraries installed.

```bash
pip install biopython pandas
